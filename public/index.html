<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Outlook Email Dropdown</title>
</head>
<body>
<form id="emailForm">
  <label for="fromEmail">From:</label>
  <select id="fromEmail"></select>
  <br><br>
  <button type="submit">Submit</button>
</form>

<script>
function loadOutlookEmails() {
  const select = document.getElementById("fromEmail");
  try {
    const outlook = new ActiveXObject("Outlook.Application");
    const ns = outlook.GetNamespace("MAPI");
    const accounts = ns.Accounts;

    for (let i = 1; i <= accounts.Count; i++) {
      const account = accounts.Item(i);
      const option = document.createElement("option");
      option.value = account.SmtpAddress;
      option.text = `${account.DisplayName} <${account.SmtpAddress}>`;
      select.appendChild(option);
    }
  } catch (e) {
    console.error("Cannot access Outlook:", e.message);
    const option = document.createElement("option");
    option.text = "Outlook not available";
    select.appendChild(option);
  }
}

// Load emails on page load
loadOutlookEmails();

// Example form submit
document.getElementById("emailForm").addEventListener("submit", (e) => {
  e.preventDefault();
  alert("Selected Email: " + document.getElementById("fromEmail").value);
});
</script>
</body>
</html>
